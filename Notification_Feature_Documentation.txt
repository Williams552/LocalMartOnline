================================================================================
                    TÃNH NÄ‚NG NOTIFICATION KHI UPLOAD HÃŒNH áº¢NH
================================================================================

ğŸ“ MÃ” Táº¢ TÃNH NÄ‚NG
================================================================================
Khi Proxy Shopper upload hÃ¬nh áº£nh chá»©ng tá»« mua hÃ ng (receipts, product photos), 
há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng táº¡o notification gá»­i cho Buyer Ä‘á»ƒ thÃ´ng bÃ¡o ráº±ng viá»‡c mua 
hÃ ng Ä‘Ã£ hoÃ n thÃ nh vÃ  sáºµn sÃ ng Ä‘á»ƒ giao.

ğŸ”§ CÃC THAY Äá»”I ÄÃƒ THá»°C HIá»†N
================================================================================

1. CAAPH NHáº¬T INTERFACE INotificationService:
   - ThÃªm method CreateNotificationAsync() Ä‘á»ƒ táº¡o notification trong database

2. CAAPH NHáº¬T NotificationService:
   - Implement CreateNotificationAsync() method
   - Táº¡o notification record trong MongoDB

3. CAAPH NHáº¬T ProxyShopperService:
   - Inject INotificationService dependency
   - Update UploadBoughtItemsAsync() Ä‘á»ƒ táº¡o notification sau khi upload thÃ nh cÃ´ng

4. CAAPH NHáº¬T ProxyShoppingOrder Model:
   - ThÃªm trÆ°á»ng ProofImages Ä‘á»ƒ lÆ°u danh sÃ¡ch URL hÃ¬nh áº£nh

5. CAAPH NHáº¬T ProxyShopperAcceptedRequestDto:
   - ThÃªm trÆ°á»ng ProofImages trong response cá»§a my-accepted endpoint

ğŸ“¤ FLOW HOáº T Äá»˜NG
================================================================================

1. Proxy Shopper gá»i API: POST /api/ProxyShopper/orders/{orderId}/proof
2. Upload thÃ nh cÃ´ng â†’ LÆ°u images vÃ o ProofImages field
3. Tá»± Ä‘á»™ng táº¡o notification cho Buyer:
   - Title: "ğŸ›ï¸ Proxy Ä‘Ã£ mua hÃ ng thÃ nh cÃ´ng!"
   - Message: Chi tiáº¿t vá» viá»‡c hoÃ n thÃ nh mua hÃ ng vÃ  upload chá»©ng tá»«
   - Type: "PROXY_SHOPPING_PROOF_UPLOADED"

ğŸ“‹ NOTIFICATION DETAILS
================================================================================

NOTIFICATION STRUCTURE:
{
  "userId": "{buyerId}",
  "title": "ğŸ›ï¸ Proxy Ä‘Ã£ mua hÃ ng thÃ nh cÃ´ng!",
  "message": "Proxy shopper Ä‘Ã£ hoÃ n táº¥t viá»‡c mua sáº£n pháº©m cá»§a báº¡n vÃ  Ä‘Ã£ upload áº£nh chá»©ng tá»«. ÄÆ¡n hÃ ng #{orderId} sáºµn sÃ ng Ä‘á»ƒ giao. HÃ£y kiá»ƒm tra áº£nh chá»©ng tá»« vÃ  xÃ¡c nháº­n Ä‘Ã£ nháº­n hÃ ng.",
  "type": "PROXY_SHOPPING_PROOF_UPLOADED",
  "isRead": false,
  "createdAt": "2025-08-01T10:30:00Z"
}

ğŸ” API ENDPOINT ÄÃƒ Cáº¢I THIá»†N
================================================================================

POST /api/ProxyShopper/orders/{orderId}/proof

REQUEST BODY:
{
  "imageUrls": [
    "https://storage.example.com/receipts/receipt_001.jpg",
    "https://storage.example.com/products/product_photo_001.jpg"
  ],
  "note": "ÄÃ£ mua Ä‘áº§y Ä‘á»§ cÃ¡c sáº£n pháº©m theo yÃªu cáº§u. HÃ³a Ä‘Æ¡n vÃ  áº£nh sáº£n pháº©m thá»±c táº¿ Ä‘Ã£ Ä‘Æ°á»£c chá»¥p."
}

ENHANCED RESPONSE:
{
  "message": "Upload áº£nh chá»©ng tá»« thÃ nh cÃ´ng.",
  "orderId": "64f1a2b3c4d5e6f7g8h9i0j1",
  "imageCount": 2,
  "uploadedAt": "2025-08-01T10:30:00Z"
}

ğŸ“± MY-ACCEPTED ENDPOINT Cáº¢I THIá»†N
================================================================================

GET /api/ProxyShopper/requests/my-accepted

RESPONSE Bá»” SUNG TRÆ¯á»œNG ProofImages:
{
  "requestId": "...",
  "orderItems": [...],
  "totalAmount": 100000,
  "proxyFee": 5000,
  "notes": "ÄÃ£ mua Ä‘áº§y Ä‘á»§ cÃ¡c sáº£n pháº©m theo yÃªu cáº§u.",
  "proofImages": [
    "https://storage.example.com/receipts/receipt_001.jpg",
    "https://storage.example.com/products/product_photo_001.jpg"
  ],
  "currentPhase": "Äang mua hÃ ng",
  "canUploadProof": true
}

ğŸ¯ Lá»¢I ÃCH Cá»¦A TÃNH NÄ‚NG
================================================================================

1. THÃ”NG BÃO REAL-TIME:
   - Buyer Ä‘Æ°á»£c thÃ´ng bÃ¡o ngay khi proxy hoÃ n thÃ nh mua hÃ ng
   - KhÃ´ng cáº§n pháº£i manually check tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng

2. MINH Báº CH:
   - Buyer cÃ³ thá»ƒ xem áº£nh chá»©ng tá»« Ä‘á»ƒ verify viá»‡c mua hÃ ng
   - TÄƒng tÃ­nh tin cáº­y cá»§a dá»‹ch vá»¥ proxy shopping

3. USER EXPERIENCE:
   - Flow mÆ°á»£t mÃ  tá»« upload proof â†’ notification â†’ buyer confirm
   - Giáº£m thá»i gian chá» Ä‘á»£i vÃ  uncertainty

4. AUDIT TRAIL:
   - LÆ°u trá»¯ Ä‘áº§y Ä‘á»§ hÃ¬nh áº£nh chá»©ng tá»«
   - CÃ³ thá»ƒ trace back lá»‹ch sá»­ giao dá»‹ch

ğŸ”’ SECURITY & ERROR HANDLING
================================================================================

1. VALIDATION:
   - Kiá»ƒm tra order status pháº£i lÃ  "InProgress"
   - Validate image URLs format
   - Authorization check cho proxy shopper

2. ERROR HANDLING:
   - Graceful handling náº¿u notification creation fails
   - Logging chi tiáº¿t cho debugging
   - KhÃ´ng affect main upload flow náº¿u notification lá»—i

3. DATABASE CONSISTENCY:
   - Atomic operations cho upload vÃ  notification
   - Rollback mechanism náº¿u cáº§n

ğŸ“… CREATED: August 1, 2025
ğŸ“„ FILE: Notification_Feature_Documentation.txt
ğŸ—ï¸ PROJECT: LocalMartOnline - Proxy Shopping Notification Module

================================================================================
